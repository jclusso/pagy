# Project specific template (pagy)

spec:
  containers:
  - env:
    # Append the env variable to the ruby container
    - (( append ))
    - name: PATH
      value: /opt/tools/bun/bin:/usr/local/bundle/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    ports:
    # append the app possible ports and retype port
    - (( append ))
    - containerPort: 8000
      hostPort: 8000
      protocol: TCP
    - containerPort: 8001
      hostPort: 8001
      protocol: TCP
    - containerPort: 8002
      hostPort: 8002
      protocol: TCP
    - containerPort: 8003
      hostPort: 8003
      protocol: TCP
    - containerPort: 8004
      hostPort: 8004
      protocol: TCP
    - containerPort: 8005
      hostPort: 8005
      protocol: TCP
    - containerPort: 8006
      hostPort: 8006
      protocol: TCP
    - containerPort: 8007
      hostPort: 8007
      protocol: TCP
    - containerPort: 8008
      hostPort: 8008
      protocol: TCP
    - containerPort: 8009
      hostPort: 8009
      protocol: TCP
    - containerPort: 5001
      hostPort: 5001
      protocol: TCP
    volumeMounts:
    - (( append ))
    - name: tools-storage
      mountPath: /opt/tools

  # Append the lightpanda container to the containers
  - (( append ))
  - name: chromium
    image: docker.io/zenika/alpine-chrome:latest
    command:
      - chromium-browser
      - --headless
      - --no-sandbox
      - --use-gl=swiftshader
      - --disable-software-rasterizer
      - --disable-dev-shm-usage
      - --remote-debugging-address=0.0.0.0
      - --remote-debugging-port=9222
    ports:
    - containerPort: 9222
      protocol: TCP

  volumes:
  - (( append ))
  - name: tools-storage
    persistentVolumeClaim:
      claimName: shared_tools
